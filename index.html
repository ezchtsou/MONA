<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>新進員工訓練回饋系統 | MONA Onboarding Feedback</title>
  <script>
    // ✅ 將 GAS EXEC URL 寫死於此（使用者可於金鑰頁面更改）
    const GAS_EXEC_URL = 'https://script.google.com/macros/s/AKfycbylnQs-FaohoCe0wdEw_xQyhLNX0jq_Hcou3Ndxgfq1YdPcs4114PNTp64b619qUpGa/exec';

    async function submitToGAS(payload){
      try {
        const res = await fetch(GAS_EXEC_URL + '?origin=' + encodeURIComponent(location.origin), {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        if (data.ok) {
          alert('✅ 已成功寫入試算表！');
        } else {
          alert('⚠️ 錯誤：' + data.error);
        }
      } catch (err) {
        alert('🚫 連線失敗：' + err.message);
      }
    }

    function handleSubmit(){
      const employeeId = document.getElementById('employeeId').value.trim();
      const fullName = document.getElementById('fullName').value.trim();
      const dept = document.getElementById('dept').value.trim();
      const date = document.getElementById('date').value;
      const feedback = document.getElementById('feedback').value.trim();

      if(!employeeId || !fullName || !dept || !feedback){
        alert('請完整填寫所有欄位');
        return;
      }

      const payload = {
        module: 'messages',
        employeeId,
        fullName,
        dept,
        date: date || new Date().toISOString().slice(0,10),
        body: feedback,
        ts: Date.now()
      };
      submitToGAS(payload);
    }
  </script>
</head>
<body style="font-family:system-ui, sans-serif; background:#f8fafc; color:#1f2937;">
  <main style="max-width:600px;margin:60px auto;background:white;padding:24px;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.1)">
    <h1 style="font-size:22px;margin-bottom:12px">MONA｜新進員工訓練回饋</h1>
    <p style="color:#6b7280;margin-bottom:20px">請填寫以下資訊，資料將自動傳入 Google 試算表</p>

    <label>使用者代號</label>
    <input id="employeeId" type="text" placeholder="例如：VHC-2025-001" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>姓名</label>
    <input id="fullName" type="text" placeholder="例如：王小明" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>單位／部門</label>
    <input id="dept" type="text" placeholder="例如：車輛課／通號課" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>日期</label>
    <input id="date" type="date" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>回饋內容</label>
    <textarea id="feedback" placeholder="請輸入您的回饋或建議..." style="width:100%;padding:8px;border-radius:8px;border:1px solid #ccc;min-height:100px"></textarea>

    <button onclick="handleSubmit()" style="margin-top:16px;width:100%;padding:10px 0;border:none;border-radius:12px;background:#0ea5e9;color:white;font-size:16px;cursor:pointer">送出</button>
  </main>
</body>
</html>
