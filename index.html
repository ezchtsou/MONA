<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ–°é€²å“¡å·¥è¨“ç·´å›é¥‹ç³»çµ± | MONA Onboarding Feedback</title>
  <script>
    // âœ… å°‡ GAS EXEC URL å¯«æ­»æ–¼æ­¤ï¼ˆä½¿ç”¨è€…å¯æ–¼é‡‘é‘°é é¢æ›´æ”¹ï¼‰
    const GAS_EXEC_URL = 'https://script.google.com/macros/s/AKfycbylnQs-FaohoCe0wdEw_xQyhLNX0jq_Hcou3Ndxgfq1YdPcs4114PNTp64b619qUpGa/exec';

    async function submitToGAS(payload){
      try {
        const res = await fetch(GAS_EXEC_URL + '?origin=' + encodeURIComponent(location.origin), {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        if (data.ok) {
          alert('âœ… å·²æˆåŠŸå¯«å…¥è©¦ç®—è¡¨ï¼');
        } else {
          alert('âš ï¸ éŒ¯èª¤ï¼š' + data.error);
        }
      } catch (err) {
        alert('ğŸš« é€£ç·šå¤±æ•—ï¼š' + err.message);
      }
    }

    function handleSubmit(){
      const employeeId = document.getElementById('employeeId').value.trim();
      const fullName = document.getElementById('fullName').value.trim();
      const dept = document.getElementById('dept').value.trim();
      const date = document.getElementById('date').value;
      const feedback = document.getElementById('feedback').value.trim();

      if(!employeeId || !fullName || !dept || !feedback){
        alert('è«‹å®Œæ•´å¡«å¯«æ‰€æœ‰æ¬„ä½');
        return;
      }

      const payload = {
        module: 'messages',
        employeeId,
        fullName,
        dept,
        date: date || new Date().toISOString().slice(0,10),
        body: feedback,
        ts: Date.now()
      };
      submitToGAS(payload);
    }
  </script>
</head>
<body style="font-family:system-ui, sans-serif; background:#f8fafc; color:#1f2937;">
  <main style="max-width:600px;margin:60px auto;background:white;padding:24px;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.1)">
    <h1 style="font-size:22px;margin-bottom:12px">MONAï½œæ–°é€²å“¡å·¥è¨“ç·´å›é¥‹</h1>
    <p style="color:#6b7280;margin-bottom:20px">è«‹å¡«å¯«ä»¥ä¸‹è³‡è¨Šï¼Œè³‡æ–™å°‡è‡ªå‹•å‚³å…¥ Google è©¦ç®—è¡¨</p>

    <label>ä½¿ç”¨è€…ä»£è™Ÿ</label>
    <input id="employeeId" type="text" placeholder="ä¾‹å¦‚ï¼šVHC-2025-001" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>å§“å</label>
    <input id="fullName" type="text" placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>å–®ä½ï¼éƒ¨é–€</label>
    <input id="dept" type="text" placeholder="ä¾‹å¦‚ï¼šè»Šè¼›èª²ï¼é€šè™Ÿèª²" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>æ—¥æœŸ</label>
    <input id="date" type="date" style="width:100%;padding:8px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc" />

    <label>å›é¥‹å…§å®¹</label>
    <textarea id="feedback" placeholder="è«‹è¼¸å…¥æ‚¨çš„å›é¥‹æˆ–å»ºè­°..." style="width:100%;padding:8px;border-radius:8px;border:1px solid #ccc;min-height:100px"></textarea>

    <button onclick="handleSubmit()" style="margin-top:16px;width:100%;padding:10px 0;border:none;border-radius:12px;background:#0ea5e9;color:white;font-size:16px;cursor:pointer">é€å‡º</button>
  </main>
</body>
</html>
